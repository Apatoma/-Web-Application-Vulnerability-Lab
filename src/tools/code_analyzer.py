import os
import re

def analyze_code(directory):
    vulnerabilities = []
    for root, dirs, files in os.walk(directory):
        for file in files:
            if file.endswith('.html') or file.endswith('.php'):
                with open(os.path.join(root, file), 'r') as f:
                    code = f.read()
                    if re.search(r"(SELECT\s+\*\s+FROM\s+.+WHERE\s+.+['\"].+['\"])", code, re.IGNORECASE):
                        vulnerabilities.append(f"Possible SQL Injection in {file}")
                    if re.search(r"(document\.write\(|innerHTML\s*=)", code, re.IGNORECASE):
                        vulnerabilities.append(f"Possible XSS vulnerability in {file}")
    return vulnerabilities

if __name__ == "__main__":
    directory = '../challenges/'
    results = analyze_code(directory)
    if results:
        print("Vulnerabilities found:")
        for result in results:
            print(result)
    else:
        print("No vulnerabilities found.")
